
# 10.5 React Fiber (Simple, Clear, Beginner-Friendly)

Fiber is the internal engine of React.
You do **not** need deep compiler-level understanding, but you MUST know what Fiber does conceptually, because it affects:

* Rendering behavior
* Performance
* Scheduling of updates
* useEffect timing
* React concurrency
* Why React does partial rendering
* Why long renders do not freeze UI

We will go slow and build conceptual clarity first.

---

# 1. What is React Fiber?

React Fiber is:

> The new (since React 16) internal architecture that allows React to break rendering work into small units and pause/resume rendering.

Before Fiber:

* React rendering was synchronous
* Long renders would freeze the UI
* Browser could not do anything until React finished

After Fiber:

* Rendering became asynchronous
* React can pause work
* React can prioritize urgent tasks
* React can drop unnecessary work

Fiber makes React faster and smarter.

---

# 2. Why Was Fiber Needed? (The Problem)

Before Fiber, React used **Stack Reconciliation**.

Problem:

* During a long render (for example list of 3,000 items), React could not stop.
* Browser became unresponsive.
* User clicks, typing, scrolling did not register.
* Apps felt slow.

Users expect modern apps to stay responsive even when UI updates are large.

React needed a rendering system that could:

* Pause work
* Continue later
* Drop unnecessary updates
* Respond to user interactions instantly

This is why Fiber was created.

---

# 3. What Fiber Actually Does (Functional View)

Fiber allows React to:

1. **Split rendering work into small pieces**
   These are called "units of work".

2. **Work on them one by one**, not all at once.

3. **Pause** if something more important happens
   Example: user is typing, clicking, scrolling.

4. **Resume** rendering when free time is available.

5. **Abort** useless work if something changed again
   Example: State changed quickly multiple times.

This is the foundation of **Concurrent Rendering** in modern React.

---

# 4. How Fiber Works Conceptually

Imagine React has 100 tasks to update UI.

Before Fiber:

* React performs all 100 tasks at once.
* Browser freezes.
* UI becomes unresponsive.

With Fiber:

* React performs 1 task.
* Checks if the browser needs time.
* Performs next task.
* Pause if needed.
* Resume later.

This is cooperative scheduling.

React works with the browser event loop to stay responsive.

---

# 5. What Are Fiber Nodes?

Each component has a Fiber Node in the Fiber tree.

Fiber Node contains:

* Component type
* Props
* State
* Effects
* Child pointer
* Sibling pointer
* Return pointer (parent)
* Alternate fiber (previous version for diffing)

You do not manipulate Fiber directly.
React manages it internally.

---

# 6. The Two-Phase Rendering Model (Very Important)

Fiber introduces a two-phase rendering model:

## Phase 1: Render Phase (Reconciliation Phase)

* React creates a new Fiber tree.
* Compares it with the old tree.
* Calculates what needs to be updated.
* This phase is **interruptible** (can pause).

## Phase 2: Commit Phase

* React applies DOM updates.
* Runs layout effects, mutation effects.
* This phase is **synchronous** (cannot pause).

Summary:

* Render phase: async, can pause
* Commit phase: sync, cannot pause

This is why:

* useEffect runs after commit
* DOM updates are stable

---

# 7. Example Component to Observe Commit vs Render

Create file:

`Render8_FiberPhases.jsx`

```jsx
import { useEffect, useState } from "react";

export default function Render8_FiberPhases() {
  const [count, setCount] = useState(0);

  console.log("Render Phase: component function executed");

  useEffect(() => {
    console.log("Commit Phase: useEffect executed");
  });

  return (
    <div>
      <h3>Fiber Render vs Commit</h3>
      <p>{count}</p>

      <button onClick={() => setCount(count + 1)}>
        Update
      </button>
    </div>
  );
}
```

Observe console:

1. First log = render phase
2. Second log = commit phase

Every time you update count:

* Render phase runs first
* DOM updates
* Then useEffect runs

---

# 8. Fiber Enables Important Features

Fiber is the engine behind:

1. **Concurrent Rendering**
2. **Suspense**
3. **Transitions**
4. **Offscreen rendering**
5. **Selective hydration**
6. **useDeferredValue**
7. **useTransition**

Without Fiber, these features would not exist.

---

# 9. Important Clarifications (avoid confusion)

Fiber:

* Does not change your component code
* Does not change how you use hooks
* Does not force new APIs
* Works internally to optimize rendering

You do not write "Fiber code".
React uses Fiber behind the scenes while rendering.

---

# 10. Summary (What You Must Remember)

React Fiber is:

* A rendering engine
* Task scheduler
* Enables async rendering
* Allows pausing and resuming work
* Makes UI responsive
* Powers concurrency

Key concepts:

* Rendering is split into small units
* Render phase is interruptible
* Commit phase is synchronous
* Fiber tree stores component information

This is the backbone of modern React.

---
