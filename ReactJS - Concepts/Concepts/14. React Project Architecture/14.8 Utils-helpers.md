

# 14.8 UTILS & HELPERS LAYER

This layer looks small, but it is critical for keeping your project clean and maintainable as it grows.

Let’s proceed step-by-step with clarity.

---

# 1. What is the Utils Layer?

Utils (utilities) are **small, reusable functions** that perform common tasks but do NOT belong to any specific component or feature.

Examples:

* Format currency
* Format dates
* Generate random IDs
* Debounce
* Throttle
* Validate email
* Parse query params
* Sort helper functions

These functions are used across the application.

Folder structure:

```
src/utils/
    currency.js
    date.js
    debounce.js
    validators.js
    storage.js
```

---

# 2. Why Do We Need Utils?

Without utils, your code becomes:

* Duplicated
* Cluttered
* Hard to maintain
* Mixed with UI
* Not reusable

By moving common logic into utils:

* All components become clean
* Helper logic is centralized
* Changes require fewer edits
* Code readability increases

This is how real production apps stay maintainable.

---

# 3. Example Utils You Will Commonly Use

---

## A) Currency Formatter

File: `src/utils/currency.js`

```jsx
export const formatCurrency = (num) => {
  return new Intl.NumberFormat("en-US", {
    style: "currency",
    currency: "USD"
  }).format(num);
};
```

Use in ProductCard:

```jsx
<p>{formatCurrency(product.price)}</p>
```

---

## B) Date Formatter

File: `src/utils/date.js`

```jsx
export const formatDate = (dateStr) => {
  return new Date(dateStr).toLocaleDateString("en-US", {
    year: "numeric",
    month: "short",
    day: "numeric"
  });
};
```

Use:

```jsx
<span>{formatDate(user.createdAt)}</span>
```

---

# 4. Debounce Utility (Very Useful for Search Input)

Debounce prevents excessive API calls while typing.

File: `src/utils/debounce.js`

```jsx
export function debounce(fn, delay = 500) {
  let timer;
  return (...args) => {
    clearTimeout(timer);
    timer = setTimeout(() => fn(...args), delay);
  };
}
```

Usage:

```jsx
const handleSearch = debounce((query) => {
  fetchProducts(query);
}, 400);
```

This is critical for performance.

---

# 5. Throttle Utility

Throttle limits execution to once per given time.

`src/utils/throttle.js`

```jsx
export function throttle(fn, delay = 300) {
  let lastCall = 0;

  return (...args) => {
    const now = Date.now();
    if (now - lastCall >= delay) {
      lastCall = now;
      fn(...args);
    }
  };
}
```

Use case:

* Scroll events
* Resize events
* Infinite scroll

---

# 6. Validators (Reusable Form Utilities)

File: `src/utils/validators.js`

```jsx
export const isEmail = (email) =>
  /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);

export const isStrongPassword = (pwd) =>
  pwd.length >= 8 && /\d/.test(pwd) && /[A-Z]/.test(pwd);
```

Use:

```jsx
if (!isEmail(email)) setError("Invalid email");
```

---

# 7. Local Storage Helpers

File: `src/utils/storage.js`

```jsx
export const saveToStorage = (key, value) => {
  localStorage.setItem(key, JSON.stringify(value));
};

export const loadFromStorage = (key) => {
  const data = localStorage.getItem(key);
  return data ? JSON.parse(data) : null;
};

export const removeFromStorage = (key) => {
  localStorage.removeItem(key);
};
```

Use anywhere:

```jsx
saveToStorage("theme", "dark");
const value = loadFromStorage("theme");
```

---

# 8. Why Utils Should Never Contain UI

Utils should contain:

* Pure functions
* Reusable logic
* No DOM operations
* No React code

Incorrect:

```
utils/modal.js — wrong (belongs in components)
utils/useTheme.js — wrong (belongs in hooks)
```

Correct layers:

* UI logic → components
* Business logic → hooks
* API logic → services
* General helpers → utils

Never mix these.

---

# 9. When to Move Logic into Utils

Move logic into utils when:

* It is repeated in 2 or more places
* It does not belong to UI
* It needs to be shared between multiple features
* It is generic logic (no React required)
* Functions must remain pure

Good examples:

* Sorting
* Filtering
* Number formatting
* Date conversions
* Query string helpers
* Validation logic

---

# 10. Utils in Feature Architecture

Modern structure:

```
src/features/products/utils/
src/features/auth/utils/
src/features/cart/utils/
```

If a utility is feature-specific, keep it inside the feature.

If it is app-wide, keep it in `src/utils`.

---

# 11. Summary of Utils Layer

You now understand:

* Utils store generic, reusable logic
* They keep UI and business logic clean
* They avoid duplication
* They improve readability
* They are pure JavaScript functions
* They work everywhere in the project
* They are essential for maintainable architecture

This layer is easy but extremely powerful.
